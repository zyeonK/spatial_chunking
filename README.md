# Spontaneous geometric chunking in human spatial navigation and its association with hippocampal subicular activity

## Software Requirements
### OS Requirements
+ Windows

## Setup Guide
### Data & Code
Download the data and code, and place them in the same directory.

## Instruction for running the code
### Data
#### sample_data.mat
This file includes x, y coordinates of target coins and responses, along with subject ID, session number (1-7), coin order (1-8), and context ID (1-5) from the multi-session behaivoral experiment.
#### sbj_pattern_all.mat
This file contains target coin/ response map for each individual participant, obtained from the multi-sesssion experiment.
#### group_pattern_data.mat
This file contains average response map and group-level t-map, obtained from the multi-sesssion experiment.
#### multi_node_model_info.mat
This file contains node sizes and spacing scales for each participant, obtained from the multi-sesssion experiment.
#### chunking_info.mat
This file contains chunking index for each participant along with tags indicating whether the coin or response is on-node or not, obtained from the multi-sesssion experiment.
#### neural_task_period_info
This folder contains task period information used for the fMRI session.

---
### Code
#### Behavioral analysis
#### behavior_code_01_target_response_pattern.m
- Generates group-level target coin distribution & response pattern (Figure 2a).
- Performs response pattern similarity analyses across participants.
#### behavior_code_02_response_pattern_across_errors.m
- Performs response pattern similarity analyses across errors and generates Figure 2b.
#### behavior_code_03_autocorrelation.m
- Conducts autocorrelation analysis and generates Figure 2c.
#### behavior_code_04_error_vector_map.m
- Generates error vector maps and produces Figure 2d.
#### behavior_code_05_multi_node_model.m
- Tests the best-fitting multi-node model for each participant and generates Figure 2f.
#### behavior_code_06_chunking_index_analysis.m
Computes chunking indices and generates Figure 3d-3f.
#### behavior_code_07_speed_analysis.m
Analyzes chunking-boundary interactions and generates Figures 3g.
#### behavior_code_08_chunking_and_boundary_interaction.m
Analyzes chunking-boundary interactions and generates Figures 3a-3b.

---
#### Neural analysis 
We conducted basic univariate GLM analysis using regressors generated by the following code:
#### neural_code_generate_regressor_basic.m
Generates task period, motion, and keypress regressors.
#### neural_code_generate_regressor_node_on_off.m
Generates additional regressors for the analysis in Figures 4c & 4d.
